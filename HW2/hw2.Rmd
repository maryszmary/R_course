---
title: "HW 2: From correlation to linear mixed-effect models. Assignment sheet"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(lme4)
library(vcd)
library(ggplot2)
```

## Задание 1

### 1.0

``` {r}
shva <- read.csv('https://raw.githubusercontent.com/agricolamz/2018-MAG_R_course/master/data/duryagin_ReductionRussian.txt', sep='\t')
```

### 1.1

``` {r}
ggplot(data=shva, aes(f2, f1)) + geom_point(aes(colour=factor(shva$vowel)), show.legend = F) + scale_y_reverse() + scale_x_reverse() + labs(title='f2 and f1 of the reduced and stressed vowels', caption="Data from Duryagin 2018")
```

### 1.2 Plot the boxplots of f1 and f2 for each vowel using ggplot().

``` {r}
ggplot(data=shva, aes(vowel, f1)) + geom_boxplot(aes(fill=factor(shva$vowel)), show.legend = F) + coord_flip() + labs(title='f1 distribution for each vowel', caption="Data from Duryagin 2018")
ggplot(data=shva, aes(vowel, f2)) + geom_boxplot(aes(fill=factor(shva$vowel)), show.legend = F) + coord_flip() + labs(title='f2 distribution for each vowel', caption="Data from Duryagin 2018")
```

### 1.3 Which f1 can be considered outliers in a vowel?

3 точки из y, одна точка из A, три точки из а

### 1.4 Calculate Pearson’s correlation of f1 and f2 (all data)

``` {r}
cor(shva$f1, shva$f2, method='pearson')
```

## Задание 3

### 3.0

``` {r}
data <- read.csv('https://raw.githubusercontent.com/agricolamz/2018-MAG_R_course/master/data/dutch_causatives.csv', sep = ',')
```

### 3.1
Критерий χ2 плохо использовать, если хотя бы в одной из клеток ожидаемое значение меньше 5
``` {r}
table <- table(data$Aux, data$CeSynt) 
chisq.test(table)
```
получаем Warning: In chisq.test(table) : Chi-squared approximation may be incorrect

``` {r}
chisq.test(table)$expected
```


Понятно почему: в одной из клеток значение 3.74. Если попробовать то же самое с остальными -- всё хорошо. Следовательно, ответ -- `Aux` ~ `CeSynt`.

``` {r}
fisher.test(table)
```


p-value < 2.2e-16. Следовательно, значима.

### 3.2 Test the hypothesis that Aux and EPTrans are not independent with the help of Pearson’s Chi-squared Test.

``` {r}
table <- table(data$Aux, data$EPTrans) 
chisq.test(table)
```
p-value = 0.0001553 -> yes, they are dependent.

### 3.3 Provide expected values for Pearson’s Chi-squared Test of Aux and EPTrans variables.
``` {r}
chisq.test(table)$expected
```

### 3.4 Calculate the odds ratio
``` {r}
fisher.test(table)$estimate
```
odds ratio = 2.601174

### 3.5 Calculate effect size for this test using Cramer’s V (phi).
``` {r}
library(questionr)
cramer.v(table)
```

### 3.6 Report the results of independence

We have found a significant association between variables `Aux` and `EPTrans` (p < 0.001). Effect size is small (Cramer's V = 0.1744882).


### 3.7 Visualize the distribution using mosaic plot.
``` {r}
library(vcd)
mosaic(~ Aux + CrSem + Country, data=data, shade=TRUE, legend=TRUE)
```

### 3.8

https://xkcd.com/882/